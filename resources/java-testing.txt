ngOnInit(): void {
  this.analyticalReportService.currentReportId$.pipe(
    takeUntil(this.destroying$),
    // switchMap handles the ID change and fetches metadata in order
    switchMap(id => {
      this.reportId = id;
      console.log('State Change Detected: New ID is', id);

      // Fetch column mappings and groupings first
      return forkJoin({
        cols: makeHttpGetRequest(this.httpClient, './api/report/column-mapping', {
          params: { reportType: this.reportType }
        }),
        groupings: makeHttpGetRequest(this.httpClient, './api/report/grouping-attr', {
          params: { reportType: this.reportType }
        })
      });
    })
  ).subscribe({
    next: (response: any) => {
      // 1. Set the Grid Structure
      this.pivotGroupColDefs = this.gridHelperService.getColModelByReportType(
        response.groupings,
        response.cols
      );

      // 2. Trigger data loading now that structure is ready
      this.loadReport();
    },
    error: (err) => console.error(err)
  });
}

---------

import { Injectable } from '@angular/core';
import { BehaviorSubject } from 'rxjs';

@Injectable({ providedIn: 'root' })
export class CommonService {
  // Use BehaviorSubject to hold the "Current" DMID state
  private dmidSource = new BehaviorSubject<any>(null);

  // Observable that components will subscribe to
  dmidState$ = this.dmidSource.asObservable();

  // Method to update the DMID from AppComponent
  updateDMID(newId: any) {
    this.dmidSource.next(newId);
  }
}

// Inside your DMID change logic
this.commonService.updateDMID(newSelectedId);

ngOnInit() {
  this.commonService.dmidState$
    .pipe(takeUntil(this.destroying$))
    .subscribe(id => {
      if (id) {
        console.log('DMID Change Detected:', id);
        this.reportId = id; //
        this.loadReport();  // Re-trigger the data fetch
      }
    });
}