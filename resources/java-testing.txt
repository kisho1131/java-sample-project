ngOnInit(): void {
  this.analyticalReportService.currentReportId$.pipe(
    takeUntil(this.destroying$),
    // switchMap handles the ID change and fetches metadata in order
    switchMap(id => {
      this.reportId = id;
      console.log('State Change Detected: New ID is', id);

      // Fetch column mappings and groupings first
      return forkJoin({
        cols: makeHttpGetRequest(this.httpClient, './api/report/column-mapping', {
          params: { reportType: this.reportType }
        }),
        groupings: makeHttpGetRequest(this.httpClient, './api/report/grouping-attr', {
          params: { reportType: this.reportType }
        })
      });
    })
  ).subscribe({
    next: (response: any) => {
      // 1. Set the Grid Structure
      this.pivotGroupColDefs = this.gridHelperService.getColModelByReportType(
        response.groupings,
        response.cols
      );

      // 2. Trigger data loading now that structure is ready
      this.loadReport();
    },
    error: (err) => console.error(err)
  });
}